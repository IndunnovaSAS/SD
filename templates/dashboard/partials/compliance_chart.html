<div id="compliance-chart-render" style="width:100%;height:100%;min-height:220px;"></div>
<script>
(function() {
    function init() {
        var el = document.getElementById('compliance-chart-render');
        if (!el || typeof echarts === 'undefined') return;
        var chart = echarts.init(el);
        chart.setOption({
            tooltip: { trigger: 'item', formatter: '{b}: {c} ({d}%)' },
            legend: { bottom: 0, left: 'center', textStyle: { fontSize: 11 } },
            series: [{
                name: 'Cumplimiento',
                type: 'pie',
                radius: ['40%', '70%'],
                center: ['50%', '45%'],
                avoidLabelOverlap: false,
                itemStyle: { borderRadius: 10, borderColor: '#fff', borderWidth: 2 },
                label: { show: false, position: 'center' },
                emphasis: { label: { show: true, fontSize: 18, fontWeight: 'bold' } },
                labelLine: { show: false },
                data: [
                    { value: {{ chart_data.completed }}, name: 'Completados', itemStyle: { color: '#22c55e' } },
                    { value: {{ chart_data.in_progress }}, name: 'En Progreso', itemStyle: { color: '#3b82f6' } },
                    { value: {{ chart_data.not_started }}, name: 'Sin Iniciar', itemStyle: { color: '#94a3b8' } },
                    { value: {{ chart_data.expired }}, name: 'Vencidos', itemStyle: { color: '#ef4444' } }
                ]
            }]
        });
        window.addEventListener('resize', function() { chart.resize(); });
    }
    if (typeof echarts !== 'undefined') { init(); }
    else { document.addEventListener('echarts:ready', init); }
})();
</script>
